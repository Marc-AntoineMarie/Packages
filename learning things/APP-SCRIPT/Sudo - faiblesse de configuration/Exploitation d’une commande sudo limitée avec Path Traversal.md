## Contexte

Sur certains systèmes Linux mal configurés, sudo peut être limité à certaines commandes sur certains fichiers ou répertoires.  
L’utilisateur normal n’a pas les droits sur un fichier sensible, mais l’utilisateur sudo ciblé peut y accéder.

## Faiblesse classique

Si la restriction ne gère pas les chemins relatifs (`..`), il est possible de sortir du répertoire autorisé et d’accéder à d’autres fichiers.

Exemple générique :

`sudo -u utilisateur_cible /bin/cat /chemin/autoris/../chemin/secret/fichier`

Explication :

- `/chemin/autoris/` : répertoire autorisé par sudo
    
- `..` : remonte d’un niveau dans l’arborescence
    
- `/chemin/secret/fichier` : fichier sensible ciblé
    

## Principe clé

La commande est exécutée avec les droits de l’utilisateur sudo ciblé.  
Si cet utilisateur a accès au fichier, tu peux le lire même si ton compte normal ne le peut pas.

## Points importants

- Vérifier toujours les commandes autorisées avec `sudo -l`.
    
- Tester les chemins relatifs pour exploiter des restrictions mal configurées.
    
- La faille ne fonctionne que si l’utilisateur sudo ciblé a les droits nécessaires sur le fichier.
    
- À ne jamais utiliser sur un vrai système sans autorisation.
    

## Exemple générique

`sudo -u utilisateur_cible /bin/cat /chemin/autoris/../chemin/secret/fichier`

Résultat : le contenu du fichier sensible s’affiche.

## Conclusion

C’est un exemple classique de CTF Linux : restriction sudo mal configurée + path traversal = accès à des fichiers sensibles.  
Cette vulnérabilité illustre pourquoi il est crucial de bien configurer sudo et de vérifier les chemins relatifs.