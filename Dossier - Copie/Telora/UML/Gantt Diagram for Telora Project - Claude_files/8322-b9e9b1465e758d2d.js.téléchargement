"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8322],{8322:function(e,t,n){n.d(t,{K5:function(){return C},Ql:function(){return R},Z1:function(){return T},_A:function(){return _},nJ:function(){return b},rN:function(){return S},wy:function(){return E},z6:function(){return w}});var r=n(36091),o=n(8571),u=n(40287),a=n(27218),c=n(27895),i=n(18850),l=n(93846),s=n(35228),f=n(6385),d=n(13262);n(92841);var v=n(87033),p=n(77930),h=n(81695),m=n(7653),g=n(19170),k=n(93513);let w=()=>{let e=(0,h.useRouter)(),t=(0,u.f)();return{refresh:()=>{e.refresh()},switchAndRefresh:(e,n)=>{t.set(f.cn.LAST_ACTIVE_ORG,e),n?location.pathname=n:location.reload()}}},y=e=>{let{account:t}=(0,a.t)(),n=(0,l.gt)(e),o=(0,r.Wc)();return(t&&o(),t&&((0,s.wJ)({account:t,isClaudeDot:e})||(0,s.c6)(t,e)))?"/onboarding":t&&(0,s.kK)(t,e)?"/invites":t&&(0,s.D_)(t,e)?"/create":t&&n?"/upgrade/pro":e?"/new":"/dashboard"};function C(e){let{value:t}=(0,v.FL)("show_affirmative_consent"),{value:n}=(0,v.FL)("show_affirmative_consent_for_privacy_policy");return(0,m.useMemo)(()=>[...t===e?["aup","consumer-terms"]:[],...n===e?["privacy"]:[]],[n,t,e])}let S=(e,t,n)=>{let r=(0,i.q)(),{mutateAsync:o}=(0,g.k7)();return(0,m.useCallback)(async()=>{if(!e||!r||0===t.length)return;let u=t.map(e=>({document_id:"v3:".concat(e,":").concat(r[e]),accepted_via_checkbox:n}));await o({acceptances:u})},[e,r,t,o,n])},_=(e,t)=>{let{account:n,refetch:r,setActiveOrganizationUUID:o}=(0,a.t)(),[u,i]=(0,m.useState)(!1),[l,s]=(0,m.useState)(!1),f=b(),{addSuccess:v}=(0,c.e)(),{data:h}=(0,g.gq)(e),k=(0,p.useQueryClient)();return(0,m.useEffect)(()=>{n&&u&&l&&(t?t(f):f())},[l,f,u,n,t]),(0,m.useCallback)(async()=>{i(!0),await r(),await k.invalidateQueries({queryKey:[d.eW]}),(null==h?void 0:h.organization_uuid)&&(o(h.organization_uuid),v("Successfully joined ".concat(h.organization_name))),s(!0)},[h,v,r,o,k])},b=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,h.useSearchParams)().get("returnTo"),n=E(e);return(0,m.useCallback)(()=>{n(t)},[n,t])},E=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{account:t}=(0,a.t)(),[n,r]=(0,m.useState)(!1),u=(0,h.useRouter)(),[c,i]=(0,m.useState)(null),l=(0,h.usePathname)(),s=(0,h.useSearchParams)(),f=(0,o.Z)(),d=y(f);return(0,m.useEffect)(()=>{(n||e)&&!t&&u.push((0,k.C2)(l,s.toString()))},[t,u,n,e,l,s]),(0,m.useEffect)(()=>{if(n&&t){let e=(0,k.eX)(t,c,d,f);e!==window.location.href.replace(window.location.origin,"")&&(u.push(e),u.refresh())}},[t,u,n,c,d,f]),(0,m.useCallback)(e=>{e&&i(e),r(!0)},[])};function T(){let[e,t]=(0,m.useState)(!1);return{getRecaptchaToken:(0,m.useCallback)(async(e,n)=>(t(!0),new Promise((r,o)=>{if("undefined"==typeof grecaptcha)return t(!1),o(Error("Recaptcha failed to load"));grecaptcha.enterprise.ready(()=>{grecaptcha.enterprise.execute(e,{action:n}).then(e=>{r(e),t(!1)},e=>{t(!1),o(e)})})})),[]),isLoading:e}}function R(e){let[t,n]=(0,m.useState)(!1);(0,m.useEffect)(()=>{if(!t){let t=setInterval(()=>{window.grecaptcha&&(n(!0),e())},10);return()=>clearInterval(t)}},[t,n,e])}},93513:function(e,t,n){n.d(t,{$6:function(){return c},C2:function(){return u},G9:function(){return a},eX:function(){return o},kY:function(){return i}});var r=n(35228);let o=(e,t,n,o)=>{if(!t||!t.startsWith("/"))return n;if((0,r.cG)(e,o)){let e=new URL(n,window.location.origin),r=new URLSearchParams(e.search);return r.set("returnTo",t),"".concat(e.pathname,"?").concat(r.toString())}return a(t)},u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/login",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="".concat(e,"?").concat(t),u=new URLSearchParams(r);return u.append("returnTo",o),"".concat(n,"?").concat(u.toString())};function a(e){let t=new URL(e,"http://example.com");return t.pathname.replace(/^\/+/,"/")+t.search}function c(e){return e.reduce((e,t)=>{let n=localStorage.getItem(t);return null!==n&&e.push([t,n]),e},[])}function i(e){e.forEach(e=>{let[t,n]=e;localStorage.setItem(t,n)})}},36091:function(e,t,n){n.d(t,{ArkoseTokenProvider:function(){return m},Wc:function(){return k},mj:function(){return g}});var r=n(27573),o=n(5362),u=n(87033),a=n(88755),c=n(45144),i=n(27522),l=n(7653),s=n(8571),f=n(18013);let d="ak-session-token",v=e=>{let{host:t,apiKey:n,nonce:o,integrity:u,onCompleted:a,onShown:c,onShow:s,onHide:f,onError:d,setArkoseEnforcement:v}=e,p=e=>{e.setConfig({onCompleted:a,onShown:c,onShow:s,onHide:f,onError:d}),v(e)};return(0,l.useEffect)(()=>()=>{window.setupEnforcement=void 0},[]),(0,r.jsx)(i.default,{id:"arkose-script",src:"https://".concat(t,"/v2/").concat(n,"/api.js"),type:"text/javascript","data-callback":"setupEnforcement",async:!0,defer:!0,onLoad:()=>{window.setupEnforcement||(window.setupEnforcement=p)},nonce:o,integrity:u,crossOrigin:"anonymous"})},p=()=>{let e=(0,a.Q)(),t=(0,s.Z)(),{value:n}=(0,u.FL)("ak_enabled");return!e&&t&&n},h=(0,l.createContext)({isChallenging:!1,lastCallerId:void 0,needsToken:!1,startTokenFlow:()=>{}});function m(e){let{host:t,apiKey:n,nonce:o,integrity:u,children:a}=e,i=p(),[s,m]=(0,l.useState)(void 0),[g,k]=(0,l.useState)(void 0),[w,y]=(0,l.useState)(!1),[C,S]=(0,f.R)(d,void 0),_=i&&!C&&!!t&&!!n;return(0,r.jsxs)(h.Provider,{value:{isChallenging:w,needsToken:_,lastCallerId:g,startTokenFlow:e=>{k(e),null==s||s.run()}},children:[a,i&&t&&n&&(0,r.jsx)(v,{host:t,apiKey:n,nonce:o,integrity:u,onCompleted:e=>{S(e.token)},onShown:()=>y(!0),onShow:()=>y(!0),onHide:()=>y(!1),onError:e=>{(0,c.Tb)(e.error)},setArkoseEnforcement:m})]})}function g(){return(0,l.useContext)(h)}let k=()=>{let e=p(),[t,n,r]=(0,f.R)(d,void 0),{mutateAsync:u}=(0,o.uC)("api/arkose/verify","POST");return(0,l.useCallback)(async()=>{e&&t&&(r(),await u({session_token:t}))},[e,u,t,r])}},18850:function(e,t,n){n.d(t,{LegalDocsProvider:function(){return a},q:function(){return c}});var r=n(27573),o=n(7653);let u=(0,o.createContext)(void 0),a=e=>{let{value:t,children:n}=e;return(0,r.jsx)(u.Provider,{value:t,children:n})};function c(){return(0,o.useContext)(u)}},93846:function(e,t,n){n.d(t,{jN:function(){return p},Iq:function(){return g},gt:function(){return m},s$:function(){return v},fk:function(){return h}});var r=n(5362),o=n(40287),u=n(27895),a=n(6385),c=n(13262),i=n(87033),l=n(7653),s=n(40950),f=n(41270);let d=e=>{if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function v(){var e;let t=(0,o.f)();return{data:d(null!==(e=t.get(a.cn.PROMOTION))&&void 0!==e?e:null),mutate:(0,l.useCallback)(e=>{t.set(a.cn.PROMOTION,JSON.stringify(e),{maxAgeSeconds:7776e3})},[t]),delete:(0,l.useCallback)(()=>{t.delete(a.cn.PROMOTION)},[t])}}function p(){var e,t;let{data:n}=v();return t=null!==(e=null==n?void 0:n.promotionId)&&void 0!==e?e:null,(0,r.WE)("/api/billing/promotion/".concat(t),{queryKey:[c.Lx,t],enabled:!!t,meta:{noToast:!0}})}function h(){let{data:e,mutate:t}=v();(0,l.useEffect)(()=>{(null==e?void 0:e.needsCheckout)&&(e.needsCheckout=void 0,t(e))},[e,t])}function m(e){let{data:t,mutate:n}=v(),r=null==t?void 0:t.promotionId,o=(0,i.Zr)("claude_ai_targeted_promotion","promotionId",null,f.z.string().nullable());return(0,l.useEffect)(()=>{!r&&o&&n({promotionId:o})},[r,o,n]),!!e&&!!(null==t?void 0:t.needsCheckout)&&!!(null==t?void 0:t.promotionId)}let g=()=>{let e=(0,l.useRef)(!1),t=(0,u.e)(),n=(0,s.Z)(),{delete:r}=v();return(0,l.useCallback)(o=>{var u;(null==o?void 0:null===(u=o.offerDetails)||void 0===u?void 0:u.offerError)&&!e.current&&(e.current=!0,t.addError(n.formatMessage({defaultMessage:"This promotion is not available for your account",id:"Vu9kt6ezVH"})),r())},[t,r,n])}}}]);